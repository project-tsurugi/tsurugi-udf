# LOADER生成手順

`udf-plugin-builder` で生成された .so プラグインを利用する際には、低レベルの `dlopen` や `dlsym` の操作を直接扱わずに、安全かつ簡単にプラグインをロードできる仕組みが必要です。LOADER は、この目的のために設計されています。

______________________________________________________________________

## 1. 実装ファイル

LOADER の生成と利用に関する実装は以下のファイルで確認できます:

- ヘッダー定義: [../../include/udf/udf_loader.h](../../include/udf/udf_loader.h)
- 実装コード: [../../src/udf/udf_loader.cpp](../../src/udf/udf_loader.cpp)

______________________________________________________________________

## 2. 生成の流れ

LOADER は以下の手順で .so プラグインを管理します:

1. 指定されたファイルまたはディレクトリから .so プラグインを探索
1. 見つかった各プラグインを `dlopen` でロード
1. `create_api_from_handle` 関数を通じて、プラグインの API と gRPC クライアントファクトリを生成
1. 生成されたオブジェクトを LOADER の内部リストに登録
1. デストラクタで全てのハンドルを自動的に解放し、リソースリークを防止

______________________________________________________________________

この手順により、ユーザーは生成されたプラグインを直接操作せずに、ロードと終了処理を安全に行うことが可能です。
